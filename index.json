{
  "index.html": {
    "href": "index.html",
    "title": "都市構造シミュレーション",
    "keywords": "都市構造シミュレーション 本システムは、3D都市モデルの建築物モデルと、その他各種データをインプットデータとして、将来の建築物の建て替え、人口、地価を推計し、将来時点の建築物の有無、用途、高さ、個人の居住地、ゾーンの地価等をシミュレーションするシステムです。"
  },
  "manual/devMan.html": {
    "href": "manual/devMan.html",
    "title": "1. インストール",
    "keywords": "1. インストール 1.1. プログラムの配置 「plateau-urban-structure-simulation-arcgis.zip」を任意のフォルダーに配置し解凍する。 1.2. ArcGIS Proの設定 ArcGIS Proを起動する。 画面右側の「カタログ」ウィンドウより「フォルダー」を右クリックし、「フォルダー接続の追加」を選択する。 1の工程で解凍した plateau-urban-structure-simulation-arcgis のフォルダーを選択した状態で「OK」をクリックする。 「カタログ」ウィンドウより「フォルダー」をダブルクリックした際に、上述の工程で選択したplateau-urban-structure-simulation-arcgis フォルダーが表示されていたら接続されている。 以降の説明で示すファイルパスは plateau-urban-structure-simulation-arcgis フォルダーからの相対パスを記述する。 1.3. ローカルシーンの起動 ArcGIS Proの「挿入」タブより「新しいマップ」をクリックし、「新しいローカルシーン」を選択する。 ローカルシーンを起動すると、ArcGIS Proの画面中央部にマップが表示される。 2. データの準備 システムを操作するために準備する必要があるデータは以下のとおりである。 データ名 ファイル名 形式 利用機能 建築物データ lod1_Building（任意に変更可） GeoDataBase 建築物データ作成機能 土地利用データ lod1_UseDistrict（任意に変更可） GeoDataBase 建築物データ作成機能 都市計画決定情報データ lod1_LandUse（任意に変更可） GeoDataBase 建築物データ作成機能 ゾーンポリゴンデータ Zone_Polygon SHP 建築物データ作成機能、インプットデータ生成機能（ゾーンデータ、交通データ、個人データ） 施設ポイントデータ Facility_Point CSV インプットデータ生成機能（ゾーンデータ） 道路NWデータ Road_NW, Road_Node SHP 建築物データ作成機能、インプットデータ生成機能（交通データ） 鉄道駅位置データ Rail_Station CSV 建築物データ作成機能、インプットデータ生成機能（交通データ） 鉄道NWデータ Rail_NW, Rail_Fare_Dist, Rail_Fare_Table CSV インプットデータ生成機能（交通データ） バス停位置データ Bus_Stop CSV インプットデータ生成機能（交通データ） バスNWデータ Bus_NW, Bus_Fare CSV インプットデータ生成機能（交通データ） 国勢調査メッシュ別人口データ （HPからダウンロードしたものから変更しない） TXT インプットデータ生成機能（個人データ） メッシュポリゴンデータ （HPからダウンロードしたものから変更しない） SHP インプットデータ生成機能（個人データ） 国勢調査世帯類型別人口データ Population_GenderAgeFamily CSV インプットデータ生成機能（個人データ） 地価データ L02-20, L01-20 SHP 都市構造シミュレーション機能 2.1. 建築物データ 2.1.1. 作成するデータ ジオデータベース形式で以下の情報を付与したポリゴンデータである。 建築物データ bldg_Building_gml_id bldg_usage1 bldg_yearOfConstruction bldg_storeysBelowGround uro_BuildingDetailAttribute_totalFloorArea bldg_537b2c69-b6fb-4a9f-8253-43caa5736f72 401 2012 2 121.24 bldg_32de5b01-b4c1-48b1-8c89-ae7ce90fe1eb 402 2022 3 222.33 bldg_dc43690e-4174-458e-a365-dff6b585b3a5 403 2004 1 444.54 bldg_86c7fb8c-7288-465d-ae4b-d4168bbff132 411 1970 5 50.23 bldg_dc43690e-4174-458e-a365-dff6b585b3a1 441 1982 10 12102.11 : : : : : 建物gml_id 用途 建築年 地上階数 延床面積 ※bldg_uasge1の用途のコード値は、3D都市モデル標準製品仕様書に準拠する。 2.1.2. 作成に利用するデータ G空間情報センターの3D都市モデル（Project PLATEAU）ポータルサイトより、CityGMLをダウンロードする。 2.1.3. データ整備方法 「3D都市モデルデータ変換ツール v2.0 for ArcGIS（ESRIジャパン社）」を用いて、3D都市モデル（CityGML）をファイルジオデータベース形式に変換する。 2.2. 土地利用データ 2.2.1. 作成するデータ ジオデータベース形式で以下の情報を付与したポリゴンデータである。 土地利用データ luse_class 211 213 214 222 212 : 土地用途区分 ※luse_classの用途のコード値は、3D都市モデル標準製品仕様書に準拠する。 2.2.2. 作成に利用するデータ G空間情報センターの3D都市モデル（Project PLATEAU）ポータルサイトより、CityGMLをダウンロードする。 2.2.3. データ整備方法 「3D都市モデルデータ変換ツール v2.0 for ArcGIS（ESRIジャパン社）」を用いて、3D都市モデル（CityGML）をファイルジオデータベース形式に変換する。 2.3. 都市計画決定情報データ 2.3.1. 作成するデータ ジオデータベース形式で以下の情報を付与したポリゴンデータである。 都市計画決定データ urf_function 9 10 11 12 1 : 地域地区の種類 ※urf_functionの地域地区のコード値は、3D都市モデル標準製品仕様書に準拠する。 2.3.2. 作成に利用するデータ G空間情報センターの3D都市モデル（Project PLATEAU）ポータルサイトより、CityGMLをダウンロードする。 2.3.3. データ整備方法 「3D都市モデルデータ変換ツール v2.0 for ArcGIS（ESRIジャパン社）」を用いて、3D都市モデル（CityGML）をファイルジオデータベース形式に変換する。 2.4. ゾーンポリゴンデータ 2.4.1. 作成するデータ SHP形式で以下の情報を付与したデータである。 ゾーンポリゴンデータ Zone_code Lat Lon 00001 35.6985 139.6917 00002 34.6937 135.5022 00003 35.1815 136.9066 00004 35.6894 139.6921 00005 35.6586 139.7454 : ゾーンコード ゾーン中心の緯度 JGD2011（EPSG:6697） ゾーン中心の経度 JGD2011（EPSG:6697） ※ジオメトリは、singlepartのPolygon、JGD2011(EPSG:6697)で整備 ※ゾーンコードは任意で設定可（連番、国勢調査の小地域コードなど） 2.4.2. 作成に利用するデータ ゾーンポリゴンは、地価や人口の演算を行う際の空間上の最小単位を決めるものである。 国勢調査小地域ポリゴンやメッシュポリゴン、パーソントリップ調査のゾーンポリゴン等、既存のポリゴンデータを利用して作成することが可能であるほか、GISソフトを用いて自由に作成することも可能である。 2.4.3. データ整備方法 ここでは例として、国勢調査小地域ポリゴンをベースにゾーンポリゴンデータを作成する手順を示す。 まず、e-stat/統計地理情報システム/境界データダウンロードより、シミュレーションの対象としたい範囲を含むデータをダウンロードする。 次に、ダウンロードしたzipファイルを解凍し、GISソフトで開き、空間座標系、フィールドの調整を行う。例として、QGISを使用する場合の手順を示す。なお、QGISの各種操作に関しては、QGISのDocumantationも参考にされたい。まず、QGISを開いて、shpファイルをレイヤに追加する。追加したレイヤは、編集モードに切り替える。 Zone_code列を作成する。Zone_code列にはゾーンポリゴンごとにユニークな文字列を入れる必要がある。たとえば、str型のZone_code列を作成し、式にto_string(@row_number)を入力することで作成できる。 不要なフィールドを削除する。ここでは、Zone_code以外のフィールドを削除する。フィールドを削除するには、レイヤを編集モードに切り替えたのち、属性テーブルを開き、フィールドの削除を選択、削除するフィールドをすべて選択してOKを押す。 ポリゴンの重心を計算する。プロセシングツールボックス/ベクタジオメトリ/重心を選択し、実行する。重心レイヤが作成される。 重心レイヤを用いて、Lat列、Lon列を作成する。まず、重心レイヤを編集モードに切り替える。フィール計算機を開き、出力する属性（フィールド）の名前、フィールド型、式を設定してOKボタンを押す。フィールド型は、いずれもreal型を指定する。式は、Latは \\$y、Lonは\\$xを入力する。最後に、重心レイヤの編集モードを終了する。 小地域ポリゴンに、重心の緯度経度を付与する。小地域ポリゴンのレイヤを右クリックし、プロパティを開き、テーブル結合を選択する。結合するレイヤは「重心」、結合基準の属性とターゲット属性はいずれも「Zone_code」を選択する。属性名の接頭辞にチェックを入れ、接頭辞を空白にし、OKを押す。 shpファイル形式で出力する。小地域ポリゴンのレイヤを右クリックし、エクスポート、新規ファイルに地物を保存を選択する。形式は「ESRI Shapefile」、ファイル名は「Zone_Polygon.shp」、座標参照系はEPSG:6697、文字コードはShift_JISを選択する。以上の設定を終えたら、OKボタンを押す。 以上の手順で作成したデータを、以下のフォルダーに配置する。 InputDataGeneration\\InputDataGeneration\\Input 2.5. 施設ポイントデータ 2.5.1. 作成するデータ CSV形式で以下の情報を付与したデータである。 施設ポイントデータ name Facility_type lat Long ○○中学校 5 35.6895 139.6917 ○△診療所 3 34.6437 135.5022 ×△クリニック 3 35.1815 136.9066 ○○病院 2 35.6894 139.6921 ○○図書館 1 35.6586 139.7454 施設名称（任意） 施設種類 1:図書館,2:病院,3:診療所,4:小学校,5:中学校,6:幼稚園こども園 緯度 経度 2.5.2. 作成に利用するデータ 各施設の緯度経度情報のデータを利用する。 国土数値情報ダウンロードサイトより、「公共施設（ポイント）」「学校（ポイント）」「医療機関（ポイント）」のデータをダウンロードして使用することができるが、独自に整備しているデータがあれば、それを使用することも可能である。 2.5.3. データ整備方法 国土数値情報ダウンロードサイトより、「公共施設（ポイント）」「学校（ポイント）」「医療機関（ポイント）」をダウンロードする。 公共施設（ポイント） 学校（ポイント） 医療機関（ポイント） ダウンロードしたzipファイルを解凍し、csv形式に変換する。ここでは、QGISを使用した手順を示す。 まず、QGISを開いて、各shpファイルをレイヤに追加する。 レイヤを選択し、編集モードに変換、緯度経度を表すLat列とLon列を作成する。この手順はゾーンポリゴンデータ作成と同様である。2列を作成したら、編集モードを終了する。この操作を、各レイヤそれぞれについて実施する。 各レイヤを、csv形式で出力する。レイヤを右クリックしてエクスポートを選択、ファイル名は任意にせて地してOKを押す。 出力したcsvファイルを、Excelで開いて編集する。適宜、国土数値情報ダウンロードにて公開されている各データの標準製品仕様を確認しながら作業を進める。 まず、図書館のポイントデータを作成する。公共施設（ポイント）データをcsv出力したものをExcelで開き、フィルターを用いて「P02_003」列が「3003」である列に絞る。 Lat列とLon列を選択し、別のシートにコピーして貼り付ける。name列、Facility_type列を作成する。name列には自由に施設名称を追加するこができる。Facility_type列には、すべて「1」を入力する。 同様の手順で、病院、診療所、小学校、中学校、幼稚園こども園についても作成する。 病院は、医療機関（ポイント）データのうち、「P04_001」列が「1」のデータを用いる。診療所は、医療機関（ポイント）データのうち、「P04_001」列が「2」のデータを用いる。小学校は、学校（ポイント）データのうち、「P29_003」列が「16001」のデータを用いる。中学校は、学校（ポイント）データのうち、「P29_003」列が「16002」のデータを用いる。幼稚園こども園は、学校（ポイント）データのうち、「P29_003」列が「16011」「16013」のデータを用いる。なお、これらの列名やコードは、各データの仕様が変更されればこの通りではなくなるため、ダウンロードするデータの仕様を確認しながら適切に選択されたい。Facility_type列は、1:図書館,2:病院,3:診療所,4:小学校,5:中学校,6:幼稚園こども園となるように値を入力する。 最後に、以上の手順で作成したデータをExcel上で縦に結合し、「Facility_Point.csv」として保存し、以下のフォルダーに配置する。 InputDataGeneration\\InputDataGeneration\\Input 2.6. 道路NWデータ 2.6.1. 作成するデータ SHP形式のLine型のNWデータ及びPoint型のノードデータの2種類からなる。 道路NW（NWデータ） LinkID NodeIDFrom NodeIDTo Length Passage＊ DirectRag＊ RoadKind Speed＊ Driveway＊ Mainroad＊ Separation Width 1 100001 100002 114 0 0 3 30 0 0 0 2 100002 100003 397 0 0 4 30 0 0 0 3 100003 100004 851 0 0 5 30 0 0 0 : : : : : : : : : : : : リンクID 始端ノードID 終端ノードID リンク長（m） リンク通行不可のフラグ 0:通行可、1:通行不可 方向規制のフラグ 0:両方向、1:縦方向（From→To）、2:逆方向（To→From）、-1:通行不可 道路種別のフラグ 速度 ※道路種別があれば不要 （km/h） 自動車専用道か一般道かのフラグ ※ダミーリンク作成に利用 0:一般道、1:自動車専用道 本線リンクかどうかのフラグ ※ダミーリンク作成に利用 0:本線リンク、1:本線リンク以外 【前面道路幅員用】上下分離されているか、そうでないか 0:上下分離なし、1:上下線分離あり 【前面道路幅員用】道路幅員 （m） ※ジオメトリは、line型、JGD2011(EPSG:6697)で整備 ※「＊」が付いている項目は空欄でもプログラム実行可能 道路NW（ノードデータ） NodeID Lat Lon NextMesh＊ NextNodeID＊ 1 35.6895 139.6917 2 2 34.6937 135.5022 5 3 35.6894 139.6921 6 : : : : : ノードID ノードの緯度 JGD2011(EPSG:6697) ノードの経度 JGD2011(EPSG:6697) 隣接メッシュコード ※DRM用の処理には必須 隣接接合ノード番号 ※DRM用の処理には必須 ※「＊」が付いている項目は空欄でもプログラム実行可能 2.6.2. 作成に利用するデータ 道路NWデータ作成には、OpenStreetMapのデータを用いる。 また、OpenStreetMapのデータに対し、ゾーンポリゴンデータにて作成したSHP形式のデータを利用することで、シミュレーション対象エリアを切り出すことが可能である。 ただし、OpenStreetMapはオープンデータで地理情報を作成するプロジェクトであり、各自治体の最新の道路状況が反映されているか、必要な属性が付与されているか等の確認が必要である。 有償のデータとしては、デジタル道路地図（DRM: Digital Road Map）があり、こちらを用いることも可能である。 2.6.3. データ整備方法 OpenStreetMapのデータを利用する場合の整備方法を示す。 2.6.3.1. OpenStreetMapのデータからシミュレーション対象範囲を切り出す まず、OpenStreetMap Data Extractsのうち、範囲をAsia-Japanと絞ったあとのデータから、シミュレーション対象としたい範囲を含むデータを「.osm.pbf」形式でダウンロードする。 ダウンロードしたファイルをGISソフトで開き、ゾーンポリゴンデータにて作成したSHP形式のデータを利用することで、シミュレーション対象エリアを切り出す操作を行う。例として、QGISを使用する場合の手順を示す。なお、QGISの各種操作に関しては、QGISのDocumantation(https://docs.qgis.org/3.4/ja/docs/index.html）も参考にされたい。 まず、QGISを開いて、「.osm.pdf」ファイルをレイヤに追加する。追加したとき、追加するアイテムを選択する必要があるため、linesを選択し、レイヤを追加を押す。 ゾーンポリゴンデータにて作成した、「Zone_Polygon.shp」をレイヤに追加し、図示したのち、「Zone_Polygon.shp」より広い範囲の地物を選択する。 linesレイヤを右クリックし、エクスポート、新規ファイルに地物を保存を選択する。形式は「ESRI Shapefile」、ファイル名はなんでも良いが、ここでは「lines.shp」とし、座標参照系はEPSG:6697、文字コードはShift_JISを選択する。以上の設定を終えたら、OKボタンを押す。 続いて、ゾーンポリゴンデータにて作成した形にデータを切り抜くため、ベクタ（O）ー空間演算ツール（G）ー切り抜く（Clip）と選択し、入力レイヤを「lines.shp」、オーバーレイレイヤを「Zone_Polygon.shp」、出力レイヤを「Road_NW.shp」として、実行を押す。 以上の操作から、対象エリアに絞ったNWデータを切り出すことができた。 2.6.3.2. Road_Nodeの作成 次に、NWデータからポイントデータを生成する。「Road_NW.shp」のレイヤに対してフィールド計算機から、「xat(0)」と入力することで、リンクの始点経度が計算される。この時、フィールド型は小数点付き数値（real）とし、精度は7、ここでの名称は、「LonFrom」とする。 同様に、終点経度は「xat(-1)」と入力し、名称は「LonTo」、始点緯度は「yat(0)」と入力し、名称は「LatFrom」、終点緯度は「yat(-1)」と入力し、名称は「LatTo」とする。 「Road_NW」レイヤを右クリックし、エクスポートー新規ファイルに保存から、形式をカンマで区切られた値[csv]を選択し、タブ下部の「保存されたファイルを地図に追加する」のチェックを外した上で、OKを押して「Road_Node.csv」を保存する。 2.6.3.3. Road_Nodeの属性フィールドの調整 「Road_Node.csv」をEXCELから開き、「LonFrom」、「LonTo」、「LatFrom」、「LatTo」の列以外は削除する。新たに「Lat」列を作成し、「LatFrom」、「LatTo」を縦に並べる。同様に、新たに「Lon」列を作成し、「LonFrom」、「LonTo」を縦に並べる。データを切り貼りする際、「Ctrl+Shift+↓」で一番下のデータまで選択することが可能である。その後、「Lat」「Lon」の2列全体を選択した後、データタブのデータツールにおける重複の削除を選択し、現在選択されている範囲を並び替えるにチェック、重複の削除を押し、OKを押す。 続いて、「NodeID」列を追加し、1から連番で数字を割り振る。「NextMesh」「NextNodeID」列も追加し、順番を「NodeID」「Lat」「Lon」「NextMesh」「NextNodeID」に並び替え、保存する。 QGISに戻り、レイヤーレイヤを追加―CSVテキストレイヤを追加と選択し、ファイル名は「Road_Node.csv」を選択、ジオメトリ定義をポイント座標X値：Lon、Y値：Lat、座標参照系はEPSG:6697、文字コードはShift_JISを選択し、追加を押すと、ポイントデータが描画される。 上記ポイントデータを、shpファイル形式で出力する。Road_Nodeのレイヤを右クリックし、エクスポート、新規ファイルに地物を保存を選択する。形式は「ESRI Shapefile」、ファイル名は「Road_Node.shp」、座標参照系はEPSG:6697、文字コードはShift_JISを選択する。以上の設定を終えたら、OKボタンを押す。 2.6.3.4. Road_NWの属性フィールドの調整 Lengthの設定 「Road_NW.shp」レイヤに対して、フィールド計算機を開き、フィールド名を「Length」、フィールド型を小数点付き数値（real）とし、ジオメトリの「$length」を選択、または、式に「$length」と入力し、OKを押す。 RoadKindの設定 以下の対応表をもとに、フィールド計算機を用いて割り当てる。 コード OSMキー 文字列 1 highway motorway 2 trunk 3 primary 4 secondary 5 tertiary 6 unclassified 7 residential 9 上記以外を割り当てる 0 不明値を割り当てる 「Road_NW.shp」レイヤに対して、フィールド計算機を開き、フィールド名を「RoadKind」、フィールド型を整数（32bit）とし、式に以下を入力し、OKを押す。 CASE WHEN \"highway\" = 'motorway' THEN 1 WHEN \"highway\" = 'trunk' THEN 2 WHEN \"highway\" = 'primary' THEN 3 WHEN \"highway\" = 'secondary' THEN 4 WHEN \"highway\" = 'tertiary' THEN 5 WHEN \"highway\" = 'unclassified' THEN 6 WHEN \"highway\" = 'residential' THEN 7 WHEN \"highway\" = 'NULL' THEN 0 ELSE 9 END Separationの設定 「Road_NW.shp」レイヤに対して、フィールド計算機を開き、フィールド名を「Separation」、フィールド型を整数（32bit）とし、式に以下を入力し、OKを押す。 CASE WHEN \"other_tags\" LIKE '%\"oneway\"=\\>\"yes\"%' THEN 1 ELSE 0 END Widthの設定 以下の対応表をもとに、フィールド計算機を用いて割り当てる。 Width RoadKind 16.000 1 16.000 2 8.000 3 8.000 4 4.000 5 4.000 6 4.000 7 2.000 9 2.000 0 「Road_NW.shp」レイヤに対して、フィールド計算機を開き、フィールド名を「Width」、フィールド型を小数点付き数値（real）とし、式に以下を入力し、OKを押す。 CASE WHEN \"RoadKind\" = 1 or 2 THEN 16.000 WHEN \"RoadKind\" = 3 or 4 THEN 8.000 WHEN \"RoadKind\" = 5 or 6 or 7 THEN 4.000 WHEN \"RoadKind\" = 9 or 0 THEN 2.000 END NodeIDFrom, NodeIDToの設定 「Road_NW.shp」レイヤをcsvファイルとしてエクスポートし、「Road_NW.csv」に対して、新たなページに「Road_Node.csv」も貼り付ける。「Road_Node」シートにおいて、一番左に、Lat列とLon列の文字列を結合した列を追加する（例えば、「=C2&D2」とする）。 「Road_NW」シートにおいて、同様にFromに関してLat列とLon列の文字列を結合した列（例えば、FromLatLon）、Toに関してLat列とLon列の文字列を結合した列（例えば、ToLatLon）を用意する。「NodeIDFrom」「NodeIDTo」列を追加し、それぞれの列に対してVLOOKUP関数を用いて、「Road_Node」シートのNodeIDを対応付ける（例えば、「=VLOOKUP(S2,Road_Node!$A:$B,2,FALSE)」とする）。 作成した「Road_NW.csv」を再度QGISにインポートし、「Road_NW.shp」を右クリックープロパティーテーブル結合―「+」ボタンと進み、結合レイヤを「Road_NW.csv」、結合基準の属性を「LinkID」、ターゲット属性を「osm_id」とし、「フィールド名の接頭辞」にチェックを入れ、接頭辞に指定されているファイル名を削除する。設定が完了したら、OKを押す。 LinkIDの設定 osm_idの列名をLinkIDに改名する。 最後に、QGISのプロセシングツールボックスに進み、「属性をリファクタリング」を検索し、名称を確認し、順番を以下の通りに並び替える。編集が終了したら、実行を押す。 LinkID、NodeIDFrom、NodeIDTo、Length、Passage（新たに作成）、DirectRag（新たに作成）、RoadKind、Speed（新たに作成）、Driveway（新たに作成）、Mainroad（新たに作成）、Separation、Width 上記NWデータを、shpファイル形式で出力する。Road_NWのレイヤを右クリックし、エクスポート、新規ファイルに地物を保存を選択する。形式は「ESRI Shapefile」、ファイル名は「Road_NW.shp」、座標参照系はEPSG:6697、文字コードはShift_JISを選択する。以上の設定を終えたら、OKボタンを押す。 以下のフォルダーに配置する。 InputDataGeneration\\InputDataGeneration\\Input 2.7. 鉄道駅位置データ 2.7.1. 作成するデータ CSV形式で以下の情報を付与したデータである。 NodeID Agency_Code Line_Code Station_Code Lat Lon Name＊ Station_Flag 101001 1 1 1 35.6895 139.6917 仙台駅 1 101002 1 1 2 34.6937 135.5022 広瀬通駅 2 102001 1 2 1 35.1815 136.9066 長町駅 3 ： ： ： ： ： ： ： ： ノードID（駅ノード） ※事業者コード、路線コード、駅コードの組み合わせで作成するとよい 事業者コード 路線コード ※同一事業者内では重複しないように付与 駅コード ※同一事業者・同一路線内では重複しないように付与 駅の緯度 JGD2011(EPSG:6697) 駅の経度 JGD2011(EPSG:6697) 駅名 駅のランク 1:中心駅、2:主要駅、3:その他の駅 ※「＊」が付いている項目は空欄でもプログラム実行可能 2.7.2. 作成に利用するデータ 鉄道駅位置データには、鉄道事業者の情報等を用いる。 自治体内の駅数が多い場合には、国土数値情報ダウンロードサイトより、「鉄道データ」がダウンロード可能であるため、活用することもできる。 2.7.3. データ整備方法 自治体内の各駅について、鉄道事業者情報もしくは民間の地図データ（Google Map等）等の情報をもとに駅のリストをExcel等の表計算ソフトウェア上で入力し作成する。 鉄道駅位置データの各項目の作成方法 項目名 内容 作成方法 NodeID ノードID 事業者コード、路線コード、駅コードを組み合わせ、重複しないようなノードIDを付与する Agency_Code 事業者コード 事業者を識別できるようにコードを付与する（コードは任意で可） Line_Code 路線コード 同一事業者の路線を識別できるようにコードを付与する（コードは任意で可） Station_Code 駅コード 同一事業者の同一路線の駅を識別できるようにコードを付与する（コードは任意で可） Lat 駅の緯度 駅名から民間の地図データ（Google Map等）で検索 Lon 駅の経度 駅名から民間の地図データ（Google Map等）で検索 Name＊ 駅名 駅名を入力 Station_Flag 駅のランク ランクはシミュレーション利用者が設定 1:中心駅、2:主要駅、3:その他の駅 ※「＊」が付いている項目は空欄でもプログラム実行可能 最後に、以上の手順で作成したデータを「Rail_Station.csv」として保存し、以下のフォルダーに配置する。 InputDataGeneration\\InputDataGeneration\\Input 2.8. 鉄道NWデータ 2.8.1. 作成するデータ CSV形式でNWのリンク情報、運賃（距離帯形式）、運賃（テーブル形式）を整理した3種類のデータからなる。 鉄道NWデータ（リンク情報） LinkID NodeID_From NodeID_To Link_Kind_Code Link_Local_Express Length_Operational＊ Length_Equivalent＊ 1 100001 100002 1 1 114 120 2 100002 100003 1 1 397 400 3 100003 100004 1 1 851 900 : : : : ： ： ： リンクID 始端ノードID 終端ノードID リンクの種類 1:幹線リンク、2:駅ダミーリンク、3:自路線乗換リンク、4:他路線乗換リンク 各駅停車／急行の列車種別 1:各駅停車、2:急行（快速等の他の列車種別がある場合には3.以降に任意で追加） ※簡易的にNWを作成する場合、列車種別は全て「1」としてもよい 運賃計算用の営業キロ ※「1:幹線リンク」のみ入力（km） 運賃計算用の換算キロ ※「1:幹線リンク」のみ入力（km） ※「＊」が付いている項目は空欄でもプログラム実行可能 鉄道NWデータ（運賃（距離帯形式）） Agency_Code Fare_System_Code Distance Fare Fare_System_Name＊ 1 1 10 300 2 1 8 300 3 2 5 250 ： ： ： ： ： 事業者コード JR等の料金体系のコード 距離帯（km） 運賃（円） 料金体系名 ※「＊」が付いている項目は空欄でもプログラム実行可能 鉄道NWデータ（運賃（テーブル形式）） NodeID1 NodeID2 Fare NodeID1_Name＊ NodeID2_Name＊ 100001 100011 310 仙台駅 荒井駅 100002 100021 310 広瀬通駅 泉中央駅 100003 100031 250 長町駅 宮城野通駅 ： ： ： ： ： ノードID（駅ノード）1 ノードID（駅ノード）2 運賃（円） 駅名1 駅名2 ※「＊」が付いている項目は空欄でもプログラム実行可能 2.8.2. 作成に利用するデータ 鉄道NWデータには、鉄道事業者の情報等を用いる。 2.8.3. データ整備方法 鉄道NWデータ（リンク情報）については、駅間の所要時間等の情報を鉄道事業者情報等をもとに、Excel等の表計算ソフトウェア上で入力し作成する。 鉄道NWデータ（リンク情報）の各項目の作成方法 項目名 内容 作成方法 LinkID リンクID 重複しないようなリンクIDを付与する NodeID_From 始端ノードID 始端が駅の場合、対応する駅のNodeID＋「0」を入力 駅ダミーの場合、対応する駅のNodeID＋1桁の数値を入力 NodeID_To 終端ノードID 終端が駅の場合、対応する駅のNodeID＋「0」を入力 ホームの場合、対応する駅のNodeID＋1桁の数値を入力 Link_Kind_Code リンクの種類 以下のリンクの種類を入力（後述） 1:幹線リンク、2:駅ダミーリンク、3:自路線乗換リンク、4:他路線乗換リンク Link_Local_Express 列車種別 各駅停車／急行の列車種別を入力 1:各駅停車、2:急行（快速等の他の列車種別がある場合には3.以降に任意で追加） Length_Operational＊ 営業キロ 運賃算出用の数値（テーブル形式の場合は不要） 鉄道事業者の時刻表等から入力、単位はキロ Length_Equivalent＊ 換算キロ 運賃算出用の数値（テーブル形式の場合は不要） 鉄道事業者の時刻表等から入力、単位はキロ Travel_Time_FromTo ToFromの所要時間 鉄道事業者の時刻表等から入力、単位は0.1分（詳細後述） Travel_Time_ToFrom FromToの所要時間 鉄道事業者の時刻表等から入力、単位は0.1分（詳細後述） Frequency_FromTo＊ FromToの運行頻度 鉄道事業者の時刻表等から入力、単位は本/h（詳細後述） Frequency_ToFrom＊ ToFromの運行頻度 鉄道事業者の時刻表等から入力、単位は本/h（詳細後述） ※「＊」が付いている項目は空欄でもプログラム実行可能 リンクの種類に関しては、幹線リンク、駅ダミーリンク、乗換リンク（自路線乗換リンク、他路線乗換リンク）が存在する。幹線リンクと駅ダミーリンクは下図のようなイメージである。 ここで駅ダミーリンクはホームを想定しているが、基本的には駅ノードと1対1対応するように作成し問題ない。乗換時間を詳細に加味したい場合には、駅ダミーを複数作成し、駅ダミー間に後述する乗換リンクを作成し所要時間を設定することで、乗換時間を詳細に加味することができる。 幹線リンク、駅ダミーリンクの作成例は下図のとおりである。幹線リンクには駅間の所要時間及び運行本数（任意）等を入力する。駅ダミーリンクには、駅から乗車場所（ホーム）までの移動時間を所要時間として入力する。 乗換リンク（自路線乗換リンク、他路線乗換リンク）の作成例は下図のとおりである。乗換リンクには、乗換に要する移動時間を所要時間として入力する。 所要時間や運行本数は、鉄道事業者のホームページ等の時刻表情報を元に作成する。例えば、JR東日本では以下のように時刻表が掲載されているため、駅間の所要時間と運行本数を入力する。 https://www.jreast-timetable.jp/2402/timetable/tt0248/0248050.html#time_16 https://www.jreast-timetable.jp/2402/train/045/047621.html 鉄道NWデータ（運賃（距離帯形式））、鉄道NWデータ（運賃（テーブル形式））については、鉄道事業者情報等をもとに、Excel等の表計算ソフトウェア上で入力し作成する。 なお、距離帯形式、テーブル形式のいずれか一方を作成すればよい。 鉄道NWデータ（運賃（距離帯形式））の各項目の作成方法 項目名 内容 作成方法 Agency_Code 事業者コード 鉄道駅位置データと同じ事業者コードを入力 Fare_System_Code JR等の料金体系のコード JR等の料金体系のコード Distance 距離帯 距離帯を入力 Fare 運賃 運賃を入力 Fare_System_Name＊ 料金体系名 任意で料金体系名を入力可 ※「＊」が付いている項目は空欄でもプログラム実行可能 鉄道NWデータ（運賃（テーブル形式））の各項目の作成方法 項目名 内容 作成方法 NodeID1 ノードID1 出発駅のNodeID（鉄道駅位置データ） NodeID2 ノードID2 到着駅のNodeID（鉄道駅位置データ） Fare 運賃 運賃 NodeID1_Name＊ 駅名1 出発駅の駅名を入力 NodeID2_Name＊ 駅名2 出発駅の駅名を入力 ※「＊」が付いている項目は空欄でもプログラム実行可能 最後に、以上の手順で作成したデータを「Rail_NW.csv」、「Rail_Fare_Table.csv」、「Rail_Fare_Dist.csv」として保存し、以下のフォルダーに配置する。 InputDataGeneration\\InputDataGeneration\\Input 2.9. バス停位置データ 2.9.1. 作成するデータ CSV形式で以下の情報を付与したデータである。 バス停位置データ agency_id stop_id stop_lat stop_lon stop_name＊ 1 121 35.6895 139.6917 木町通二丁目 2 203 34.6937 135.5022 台原入口 3 56 35.1815 136.9066 台原三丁目 ： ： ： ： ： 事業者ID 停留所・標柱ID バス停の緯度 JGD2011(EPSG:6697) バス停の経度 JGD2011(EPSG:6697) 停留所名 ※「＊」が付いている項目は空欄でもプログラム実行可能 2.9.2. 作成に利用するデータ バス停位置データには、GTFS（標準的なバス情報フォーマット）のデータを用いる。 GTFSのデータは各データを整備している自治体や事業者のホームページで公表されている。公開されているホームページの一覧はhttps://tshimada291.sakura.ne.jp/transport/gtfs-list.html等で確認することができる。 GTFSの詳細な仕様やルールに関しては、国土交通省の技術資料（仕様書、ガイドライン）を参考にされたい。 なお、GTFSで公開されているデータには、最新のバス路線に対応していない、位置情報等に不正確な情報が含まれている可能性があるため、留意して利用する必要がある。 GTFSが整備されていない場合は、事業者のホームページ等のバス停マップや時刻表等を参照し作成する。なお、バス停位置情報に関しては、国土数値情報ダウンロードサイトより、「バス停留所（ポイント）」や「バスルート（ライン）」のデータがダウンロード可能であるため、活用することもできる。 2.9.3. データ整備方法 GTFSのデータを利用する場合の整備方法を示す。 事業者の情報等をもとに作成する方法は「4-7.鉄道駅位置データ」や「4-8.鉄道NWデータ」を参考にされたい。 GTFSは各データを整備している自治体や事業者のホームページで公表されているため、自治体や事業者のホームページにアクセスし、ダウンロードする。 例えば、仙台市営バスは仙台市の以下のホームページ上で公開されており、仙台市営バス情報をクリックすることでGTFSデータがダウンロードできる。 バス停位置データは、GTFSの以下の各ファイルの各項目を、Excel等のCSV形式を扱えるソフトウェアを用いて切り出して作成する。 バス停位置データとGTFSの対応 項目名 内容 GTFSファイル名 GTFS項目名 備考 agency_id 事業者ID agency.txt agency_id stop_id 停留所・標柱ID stops.txt stop_id stop_lat バス停の緯度 stops.txt stop_lat JGD2011(EPSG:6697) stop_lon バス停の経度 stops.txt stop_lon JGD2011(EPSG:6697) stop_name 停留所名 stops.txt stop_name なお、GTFSはTXT形式でデータが整備されているが、カンマ区切りのCSVとしてファイルを開くことが可能である。例えば、ExcelではTXT形式のままファイルを開こうとすると、以下のようなダイアログが表示されるが、「カンマやタブなどの区切り文字によってフィールドごとに区切られたデータ」を選択し、区切り文字に「カンマ」を指定することで、ファイルを開くことができる。 最後に、以上の手順で作成したデータを「Bus_Stop.csv」として保存し、以下のフォルダーに配置する。 InputDataGeneration\\InputDataGeneration\\Input 2.10. バスNWデータ 2.10.1. 作成するデータ CSV形式でNWのリンク情報、運賃を整理した2種類のデータからなる。 バスNWデータ（リンク情報） agency_id route_id jp_pattern_id stop_id1 stop_id2 travel_time Frequency＊ 1 12 121 100001 100002 10 40 2 5 52 100002 100003 36 30 3 17 172 100003 100004 77 10 ： ： ： ： ： ： ： 事業者ID 経路ID (いわゆる系統を示す) 停車パターンID (系統内で複数の停車パターン（途中折り返し等）がある場合には別IDを付与) 停留所・標柱ID1 停留所・標柱ID2 (0.1分) 運行本数(本/日) ※「＊」が付いている項目は空欄でもプログラム実行可能 バスNWデータ（運賃） agency_id route_id stop_id1 stop_id2 fare 1 12 121 5 300 2 5 203 11 400 3 17 56 20 200 ： ： ： ： ： 事業者ID 経路ID 停留所・標柱ID1 停留所・標柱ID2 運賃（円） 2.10.2. 作成に利用するデータ バスNWデータには、GTFS（標準的なバス情報フォーマット）のデータを用いる。詳細は「4-10.バス停位置データ」を参考されたい。 2.10.3. データ整備方法 GTFSのデータを利用する場合の整備方法を示す。 事業者の情報等をもとに作成する方法は鉄道駅位置データや鉄道NWデータを参考にされたい。 GTFSデータのダウンロードはバス停位置データを参考されたい。 バスNW停位置データは、GTFSの以下の各ファイルの各項目を、Excel等のCSV形式を扱えるソフトウェアを用いて切り出して作成する。 バスNWデータ（リンク情報）とGTFSの対応 項目名 内容 GTFSファイル名 GTFS項目名 備考 agency_id 事業者ID agency.txt agency_id route_id 経路ID trips.txt route_id jp_pattern_id 停車パターンID trips.txt jp_pattern_id stop_id1 停留所・標柱ID1 stop_times.txt stop_id 一部切り出し（後述） stop_id2 停留所・標柱ID2 stop_times.txt stop_id 一部切り出し（後述） travel_time 所要時間 stop_times.txt arrival_time 到着時刻の差分（後述） frequency 運行本数 stop_times.txt trip_id 運行本数カウント（後述） バスNWデータ（運賃）とGTFSの対応 項目名 内容 GTFSファイル名 GTFS項目名 備考 agency_id 事業者ID agency.txt agency_id route_id 経路ID fare_rules.txt route_id stop_id1 停留所・標柱ID1 fare_rules.txt origin_id stop_id2 停留所・標柱ID2 fare_rules.txt destination_id fare 運賃 fare_attributes.txt price バスNWデータ（リンク情報）を作成する際には、GTFSデータのstop_times.txtのデータを基に作成することになるが、stop_times.txtはダイヤデータであり各径路（route_id）の全てのダイヤ（trip_id）の情報が記録されているため（下図参照）、バスNWデータ（リンク情報）とする際には、各径路の代表的なダイヤ（trip_id）を1つだけ抜き出す。代表的なダイヤは、最も運行本数が多い時間帯や朝ピーク時に設定するなど、作成者の任意の方法で設定してかまわない。 所要時間は、停留所間のarrival_timeの差分で算出する。また、運行本数はroute_id毎のtrip_idの数をカウントすることで作成する。 なお、stop_times.txtにはroute_idの情報が付与されておらず、trips.txt（下図参照）にtrip_idとroute_idの対応が整理されているため、参照して付与する。 最後に、以上の手順で作成したデータを「Bus_NW.csv」、「Bus_Fare.csv」として保存し、以下のフォルダーに配置する。 InputDataGeneration\\InputDataGeneration\\Input 2.11. 国勢調査メッシュ別人口データ 2.11.1. 作成するデータ 令和2年度国勢調査のテキストデータである。 e-Statで公開されている、令和2年国勢調査の「人口及び世帯」のうち、5次メッシュ（250mメッシュ）のデータを利用する。 2.11.2. 作成に利用するデータ e-Statより、令和2年国勢調査の「人口及び世帯」のうち、5次メッシュ（250mメッシュ）データをダウンロードして使用する。 2.11.3. データ整備方法 e-Statより、シミュレーション対象範囲を含むすべての令和2年国勢調査の「人口及び世帯」の5次メッシュ（250mメッシュ）データをダウンロードする。 ダウンロードしたファイルを解凍し、下記のフォルダーに配置する。 InputDataGeneration\\InputDataGeneration\\Input\\pop_mesh 2.12. 500mメッシュポリゴンデータ 2.12.1. 作成するデータ ５次メッシュ（250mメッシュ）のポリゴンデータである。 2.12.2. 作成に利用するデータ e-Statより、5次メッシュ（250mメッシュ）のゾーンポリゴンのデータをダウンロードして使用する。 2.12.3. データ整備方法 e-Statより、シミュレーション対象範囲を含むすべての5次メッシュ（250mメッシュ）のゾーンポリゴンのデータをダウンロードする。 ダウンロードしたファイルを解凍し、下記のフォルダーに配置する。この際、shpファイルの他、dbf、prj、shxファイルもフォルダー内に配置する。 InputDataGeneration\\InputDataGeneration\\Input\\zone_mesh 2.13. 国勢調査世帯類型別人口データ 2.13.1. 作成するデータ CSV形式で以下の情報を付与したデータである。 国勢調査世帯類型別人口データ age gender family pop 1 1 1 0 1 1 2 0 1 1 3 8697 1 1 4 411 ： ： ： ： 年齢階層 0:0~14歳,1:15~64歳, 2:65歳以上 性別 1:男性, 2:女性 家族類型 1:単身世帯,2:夫婦のみ世帯,3:夫婦と子の世帯,4:ひとり親と子の世帯,5:その他の世帯 人口（人） 2.13.2. 作成に利用するデータ e-Statで公表されている国勢調査 令和２年国勢調査 人口等基本集計 （主な内容：男女・年齢・配偶関係，世帯の構成，住居の状態，母子・父子世帯，国籍など）を用いることができる。 2.13.3. データ整備方法 e-statの当該集計表のデータベースにアクセスする。「表示項目選択」にて、フィルターを設定する。「配偶関係」は「総数」のみを選択する。「年齢」を、0～4歳、5～9歳、・・・、80～84歳、（再掲）85歳以上を選択する。「世帯の種類・世帯の家族類型・施設等の世帯の種類」は「総数」「夫婦のみの世帯」「夫婦と子供から成る世帯」「男親と子供から成る世帯」「女親と子供から成る世帯」を選択する。「全国～人口50万以上の市」では、シミュレーション対象とする市町村を選択する。 「確定」→「ダウンロード」を押し、ファイル形式は「CSV形式(列指向形式・Shift-JIS)」を選択、ダウンロードを行う。 ダウンロードしたcsvファイルをExcelで開き、加工する。 年齢を表す「cat04_code」列のうち、85歳以上を表す「R5」については、「18」で置き換え、列名を「age」に変更する。 性別を表す「cat01_code」列は、列名を「gender」に変更する。 家族類型を表す「cat03_code」列は、列名を「family」に変更する。値は、1:単身世帯, 2:夫婦のみ世帯,3:夫婦と子の世帯,4:ひとり親と子の世帯となるように、Excel上で置換を行う。 人数を表す「value」列は、列名を「pop」に変更する。「-」は「0」で置換する。 age, gender, family, pop以外の列を削除する。 その他の世帯の人数を求める。まず、age, gender, family, popの4列を選択し、ピボットテーブルを作成、ageとgenderを行に、popを値に、familyをフィルターに設定する。familyは、合計を表す「0」を選択する。 同様に、familyのフィルターを、合計を表す「0」以外を選択したものを、隣に作成する。 二つのピボットテーブルで集計された値の差分を計算する。これが、その他の世帯の性別年齢別人口となる。familyを「5」とし、ピボットテーブルで参照していた範囲の最下部に、コピーして貼り付ける。 最後に、family列で「0」の行を削除し、シートを「Population_GenderAgeFamily.csv」として保存、以下のフォルダーに配置する。 InputDataGeneration\\InputDataGeneration\\Input 2.14. 地価データ 2.14.1. 作成するデータ 地価公示及び都道府県地価調査のポイントデータである。 国土数値情報ダウンロードサイトで公表されている、「地価公示（ポイント）」データおよび「都道府県地価調査（ポイント）」データの、製品仕様書第3.1版に準拠したものを用意する。 2.14.2. 作成に利用するデータ 国土数値情報ダウンロードサイトより、「地価公示（ポイント）」「都道府県地価調査（ポイント）」のデータをダウンロードして使用する。 2.14.3. データ整備方法 シミュレーション対象とする範囲が含まれる、「地価公示（ポイント）」「都道府県地価調査（ポイント）」のデータをダウンロードする。 ファイル名を、「地価公示（ポイント）」は「L01-20.shp」、「都道府県地価調査（ポイント）」は「L02-20.shp」とする。xml、dbf、prj、shxファイルについても、同様にファイル名を変更する。 以下のフォルダーに配置する。 InputDataGeneration\\InputDataGeneration\\Input"
  },
  "manual/userMan.html": {
    "href": "manual/userMan.html",
    "title": "1. 本システムの概要",
    "keywords": "1. 本システムの概要 1.1. 都市構造シミュレーションの概要 人々の活動がますます多様化する昨今、人々のウェルビーイング向上と持続可能な都市経営を実現するため、市民をはじめとする多様なステークホルダーがまちづくりの将来ビジョンを共有し、共感を得ながらビジョンを実現していくプランニングプロセスの必要性が高まっている。 都市構造シミュレーションは、3D都市モデルを活用し、立地適正化計画等のまちづくり施策が都市構造に与える影響をわかりやすく可視化するシミュレータである。また、ビジョンを広く共有するためのツールとして地方公共団体やコンサルタント等が活用しやすいよう、データ整備～シナリオ設定～シミュレーション～可視化までを簡便に実施することができるユーザーインターフェースを実装している。 本都市構造シミュレーションシステムは、ArcGISのツールボックスとしてOSSとして開発をしており、ファイルをPLATEAUホームページよりダウンロードすることで、ArcGIS Proを利用可能なPCであれば、無料で利用することが可能である。 都市構造シミュレーションシステムの概要 1.2. システムの利用フロー ユーザーは初めにソフトウェアのインストールを行い、各機能を利用可能な状態にする。ユーザーはソフトウェアインストール後に建築物データ作成機能及びインプットデータ生成機能を実行し、初期データのセットアップを行う。ユーザーは初期セットアップ完了後、シミュレーションのためのシナリオ設定を行う。シナリオ設定は初期セットアップ時に設定したゾーン毎に行う。 シナリオ設定後、作成したシナリオデータを都市構造シミュレーションに渡し実行する。都市構造シミュレーションは作成したシナリオ毎に実行する。 ユーザーは3D可視化機能によりシミュレーション結果を3D地図上に可視化する。ユーザーは同一シナリオの年次毎の比較やシナリオ間の比較を行い、適切な施策の検討に用いる。 システムの利用フロー 1.3. 各システムの機能概要 実証システムの機能概要は以下の通りである。 分類 機能名 機能説明 建築物データ作成機能 FootPrint作成 建築物データの立地していない空地に対して、今後建築物が建設され得る領域としてFootPrintを追加作成 商業地域において敷地が統合されるFootPrintを作成 欠損値補完 建築物データの用途、地上階数、延べ床面積、築年数の欠損を補完 ゾーンコード等付与 建築物データの各FootPrintのポリゴン重心が位置するゾーンのゾーンコードを建築物データに付与、また建築物データの各FootPrintのポリゴン重心と最寄り鉄道駅との直線距離と駅名及び前面道路幅員を付与 インプットデータ作成機能 呼出し ユーザーからのファイルパス入力を受け付けた上で、各データ作成機能を呼出し、ファイルパスを受け渡す ゾーンデータ作成機能 ゾーンデータに、そのゾーン内に立地する公共施設の数を集計して付与 また、ゾーンデータに、そのゾーン内の最も多くを占める用途地域を付与、そのゾーンのポリゴン重心と最寄り鉄道駅との直線距離と駅名を付与 交通データ作成機能 全てのゾーンペアに対して、ポリゴン重心間の移動時間を鉄道、バス、自動車それぞれ作成して出力 個人データ生成 国勢調査人口データとゾーンデータから、個人の性年齢・世帯類型等の属性と居住地のデータを出力 シナリオ設定UI機能 ゾーン情報設定 都市計画情報設定 シナリオ設定UIおけるゾーンの選択、選択したゾーンの用途地域及び容積率の変更、変更後の建築物データ・ゾーンデータ出力 施設数設定 シナリオ設定UIおけるゾーンの選択、選択したゾーンの公共施設数の変更、変更後のゾーンデータの出力 都市機能誘導・居住誘導施策設定 シナリオ設定UIおけるゾーンの選択、選択したゾーンの都市機能誘導施策（商業地価の増減割合）の設定、居住誘導施策（住宅地価の増減割合）の設定、変更後のゾーンデータの出力 当該ゾーン間所要時間設定 シナリオ設定UIおけるゾーンの選択、選択したゾーンを交通施策の対象とするかどうかのフラグ付与、鉄道乗車時間・待ち時間、バス乗車時間・待ち時間等の増減割合の設定、変更後の手段別ゾーン間所要時間データの出力 都市構造シミュレーション機能 都市構造シミュレーション機能 地価モデル 周辺の人口や建築物の立地状況、他ゾーンまでの所要時間等から、ゾーン毎の住宅地価及び商業地価を出力 転居発生・転入転出・居住地選択モデル 個人の性年齢・世帯類型等から、個人毎に翌年の年齢・世帯類型、転居有無、市外への転出・市内への転入の有無、転居後の居住地を出力 敷地統合分割モデル ゾーンの地価や用途地域、容積率、他ゾーンまでの所要時間等から、個々の建築物が隣接する建築物と敷地を統合して一体的な敷地となるかどうか、個々の建築物が複数の敷地に分割され別々の敷地となるかどうかを出力 除却・建設・用途選択モデル ゾーンの地価や用途地域、容積率、他ゾーンまでの所要時間等から、個々の建築物が除却有無、空地への新規建設有無、建設される場合の用途・階数・高さ・延べ床面積を出力 3D可視化機能 可視化 シミュレーションの結果をArcGIS Proの画面上に3次元で可視化する 1.4. 必要な入力データの種類 シミュレーションを実施するために準備する必要があるデータは以下のとおりである。 （具体的な整備方法は、データの準備を参照） 1.4.1. 建築物データ作成機能 建築物データ [GeoDataBase形式] 土地利用現況データ[GeoDataBase形式] 都市計画決定情報データ[GeoDataBase形式] ゾーンポリゴンデータ[shp形式] 道路NWデータ[shp形式] 鉄道駅位置データ[csv形式] 1.4.2. インプットデータ生成機能 ゾーンポリゴンデータ[shp形式] 施設ポイントデータ[csv形式] 道路NWデータ[shp形式] 鉄道駅位置データ[csv形式] 鉄道ＮＷデータ[shp形式] バス停位置データ[csv形式] バスＮＷデータ[csv形式] 国勢調査メッシュ別人口データ[txt形式] 250mメッシュポリゴンデータ[shp形式] 国勢調査世帯別人口データ[csv形式] 1.4.3. 都市構造シミュレーション機能 地価データ[shp形式] 2. シミュレーション方法 2.1. 建築物データ作成機能 ArcGIS Proの「カタログ」欄より下記のフォルダーを表示し、「建築物データ作成機能」をダブルクリックして起動する。 InputDataGeneration\\Tool\\PlateauInputDataGenerationTools.atbx 「建築物データ作成機能」画面の各項目に入力データを指定する。 インプットデータ指定後に「実行」ボタンを押す。 2.2. インプットデータ生成機能 2.2.1. データの配置 以下のフォルダーにインプットデータ生成機能の入力データを配置する。 InputDataGeneration\\InputDataGeneration\\Input 2.2.2. インプットデータ生成機能の起動 ArcGIS Proの「カタログ」欄より下記のフォルダーを表示し、「インプットデータ生成機能」をダブルクリックして起動する。 InputDataGeneration\\Tool\\PlateauInputDataGenerationTools.atbx 画面起動後に該当エリアのEPSGコードを入力し、「実行」ボタンを押し処理を実行する。 処理が完了すると、シーンに「ZoneData」が追加される。 2.3. シナリオ設定UI機能 2.3.1. 通常の操作方法 2.3.1.1. シナリオ設定UI機能の起動 ArcGIS Proの「カタログ」欄より下記のフォルダーを表示し、「シナリオ設定UI」をダブルクリックして起動する。 Simulation\\Tool\\PlateauSimulationTools.atbx シナリオ設定UIの選択 2.3.1.2. シナリオ設定UI機能のパラメータ入力 シナリオ設定UI機能で必要なパラメータを入力する。入力可能なパラメータ一覧は表1のとおりである。 シナリオ設定UIのパラメータ入力画面 シナリオ設定UI入力パラメータ一覧表 入力項目 入力する内容 施設数 図書館の数 ゾーン内の図書館の数を指定します 病院の数 ゾーン内の病院の数を指定します 中学校の数 ゾーン内の中学校の数を指定します 幼稚園および子供園の数 ゾーン内の幼稚園及び子供園の数を指定します 施設数の開始年次 ※2 指定した施設数が適用される期間の開始年次を指定します 都市計画情報 用途地域 ゾーンの用途地域を指定します 容積率（%） ゾーンの容積率を指定します 都市情報の開始年次 ※2 指定した都市計画情報が適用される期間の開始年次を指定します 地価変更割合 商業地価変更割合（%） 商業地価の割増率（%）を指定します 住宅地価変更割合（%） 住宅地価の割引率（%）を指定します 地価変更割合の開始年次 ※2 指定した地価変更割合が適用される期間の開始年次を指定します 転入転出割合 転入率（%） 転入率の変化率（%）を指定します 転出率（%） 転出率の変化率（%）を指定します 転入転出割合の開始年次 ※2 指定した転入転出割合が適用される期間の開始年次を指定します 公共交通 鉄道乗車時間（%） 鉄道乗車時間を現況からの割合（%）で指定します 鉄道待ち時間（%） 鉄道待ち時間を現況からの割合（%）で指定します 鉄道アクセス時間（%） 鉄道アクセス時間を現況からの割合（%）で指定します 鉄道イグレス時間（%） 鉄道イグレス時間を現況からの割合（%）で指定します 鉄道運賃（%） 鉄道運賃を現況からの割合（%）で指定します バス待ち時間（%） バス待ち時間を現況からの割合（%）で指定します バス運賃（%） バス運賃を現況からの割合（%）で指定します 公共交通情報の開始年次 ※2 指定した公共交通の設定が適用される期間の開始年次を指定します 公共交通情報の終了年次 指定した公共交通の設定が適用される期間の終了年次を指定します ※1 「シナリオ名」、「ゾーンコード」、「シナリオ開始年次」、「シナリオ終了年次」の4項目は入力必須項目。 ※2 施設数等の各施策の「開始年次」は、「シナリオ開始年次」の翌年以降で設定。 ゾーンポリゴンのパラメータ入力欄はデフォルト（ZoneData）のままとし、シーンの「ZoneData」から施策を実施したい該当エリアのポリゴンを選択した上で実行する。 シーンに「ZoneData」が追加されていない場合は、下記ディレクトリより「ZoneData」をシーンに追加した上で選択する。 Simulation\\BaseData\\BaseData.gdb\\ZoneData 「カタログ」欄でゾーンポリゴンがあるフォルダー（Simulation\\BaseData\\BaseData.gdb）を表示し、「ZoneData」をシーンへドラッグアンドドロップする。 「マップ」タブの選択ツールを使用し、該当エリアのポリゴンをクリックすることで選択できる。 「マップ」タブの「属性」をクリックした上でゾーンコードを調べたい箇所のポリゴンを選択すると、ポップアップウィンドウの中に選択したゾーンの zone_code や各種施設の数が表示される。 2.3.1.3. シナリオ設定UI機能の実行 各種パラメータを入力およびゾーンを選択した状態で、シナリオ設定UI機能の実行ボタンをクリックして処理を実行する。 2.3.2. 複数施策を1つのシナリオで設定したい場合 2.3.2.1. シナリオの新規作成 立地適正化計画が実現した場合をシナリオとしてシミュレーションしたい場合、「都市機能誘導区域における容積率の緩和」、「居住誘導区域における家賃補助」といったように、異なる区域での複数種類の施策を1つのシナリオとして実施する必要がある。 その場合には、シナリオ名を指定する際に、既存のシナリオを指定した上で、異なるゾーンを選択しなおして再度実行することで、1つのシナリオで複数施策を設定することが可能である。 1回目のシミュレーションは前項に示した通り任意のシナリオ名を設定して実行する。 2.3.2.2. 施策の追加設定 2回目以降のシミュレーションでは、既存のシナリオ名を指定した上で、異なるゾーンを選択して実行する。 2.3.3. 施策を設定せずにシミュレーションを実施する場合（趨勢シナリオの実施） 施策を何も行わない場合の将来（いわゆる趨勢シナリオ）をシミュレーションしたい場合には、施策を何も設定せずにシナリオ設定UIを実行する必要がある。 具体的には、シナリオ設定UIにてシナリオ名、ゾーン選択、シナリオ開始年次、シナリオ終了年次のみを設定し、その他の項目は空欄のまま実行する。 2.4. 都市構造シミュレーション機能 2.4.1. 都市構造シミュレーション機能の起動 ArcGIS Proの「カタログ」欄より下記のフォルダーを表示し、「都市構造シミュレーション機能」をダブルクリックして起動する。 Simulation\\Tool\\PlateauSimulationTools.atbx ![都市構造シミュレーション機能の起動](../resources/userMan/fig19.png) 2.4.2. シナリオ格納ディレクトリの設定 「シナリオ格納ディレクトリ」欄にシミュレーションを実施したいシナリオが格納されているフォルダーを設定する。 Simulation\\Scenario\\{シナリオ名} 2.4.3. 都市構造シミュレーション機能の実行 都市構造シミュレーション機能の実行ボタンをクリックして処理を実行する。 都市構造シミュレーション機能の処理が完了すると、Output フォルダーに設定したシナリオ名のフォルダーが作成され、シミュレーション結果ファイルが保存されていることが確認できる。 2.5. 3次元可視化機能 2.5.1. 3次元可視化機能の起動 ArcGIS Proの「カタログ」欄より下記のフォルダーを表示し、「3次元可視化機能」をダブルクリックして起動する。 Simulation\\Tool\\PlateauSimulationTools.atbx 2.5.2. 比較されるシナリオの設定 「比較されるシナリオ」欄で比較される側のシナリオとして、都市構造シミュレーション機能によって作成されたCSVファイルの中から、3次元可視化対象とする年次のものを選択する。CSVファイルは以下の命名規則で生成されている。（Building以外のデータを選択するとエラーが出るため注意） Output\\{シナリオ名}\\Building{年次}.csv 「比較するシナリオ」は着目したいシナリオ、「比較されるシナリオ」は基準となるシナリオである。例えば、「都市機能誘導シナリオ」と「趨勢シナリオ」の建築物用途の比較をしたい場合、「比較するシナリオ」として「都市機能誘導シナリオ」を、「比較されるシナリオ」として「趨勢シナリオ」を入力する。 2.5.3. 比較するシナリオの設定 「比較するシナリオ」欄で比較する側のシナリオとして、都市構造シミュレーション機能によって作成されたCSVファイルの中から、3次元可視化の対象とする別の年次又は別のシナリオのファイルを選択する。 Output\\{シナリオ名}\\building{年次}.csv 2.5.4. 比較項目の設定 「比較項目」欄で比較する項目を下記の項目から選択する。 建築物用途の比較 建築物用途を住宅、住宅以外、空地に分類して比較する。 建築物用途の比較_詳細 建築物用途の値で比較する。 建築物存在有無の比較 建築物ができるか、空地になるかで分類する。 建築物高さの差分 建築物高さの増減で比較する。 2.5.5. 3次元可視化機能の実行 3次元可視化機能の実行ボタンをクリックして処理を実行する。 処理が完了すると、ArcGIS Proのローカルシーンにシナリオ比較によって着色された3D都市モデルが表示される。 2.6. シナリオの設定例 2.6.1. 設定可能な施策 シナリオ設定UI機能を用いることで、以下の施設整備、都市機能誘導、居住誘導、公共交通等の施策を設定することが可能 対象施策 シナリオ設定UI機能 対応施策名 インブットデータ 手作業変更による対応 施設整備 公共施設等の整備 - ソーンの施設数の変更 - 施設数 都市機能誘導 商業施設の誘導(税制優遇等) - ソーンの商業地価割増率の変更 - 商業地価変更割合 容積率の緩和 - ソーンの容積率の変更 - 都市計画情報 用途地域の変更 - ソーンの用途地域の変更(用途制限緩和) - 都市計画情報 居住誘導 税制優遇や補助等による居住誘導 - ソーンの住宅地価の割引率の変更(世帯類型別に設定) - 住宅地価変更割合 公共交通 鉄道バスの新規開業・路線変更 簡易設定 - ソーンの最寄り駅距離の変更 - ソーン間所要時間の割合を一律変更 - 鉄道変更 - バス変更 詳細設定 - 鉄道NWデータ(ライン)の差し替え - 鉄道駅データ(ポイント)の差し替え - バスNWデータの差し替え 鉄道バスの運行頻度向上 簡易設定 - ソーン間所要時間の割合を一律変更 - 鉄道変更 - バス変更 詳細設定 - 鉄道NWデータ(ライン)の差し替え - バスNWデータの差し替え 鉄道バスの料金割引 簡易設定 - ソーン間所要時間の割合を一律変更(割引料金を時間換算して所要時間から引く) - 鉄道変更 - バス変更 詳細設定 - 鉄道NWデータ(ライン)の差し替え ・バスNWデータの差し替え そのほか 転入転出割合の変化 - 転入率、転出率の変更割合の変更 - 転入転出割合 2.6.2. シナリオ設定例 2.6.2.1. シナリオ①：都市機能誘導シナリオ 都市機能誘導シナリオとして、2020年をシミュレーション開始年次とし、20年後の2040年までをシミュレーションする。 具体の施策としては「都心中心部における容積率の緩和」、「都市機能誘導区域における建替促進助成」の2つを設定することとする。 施策 設定内容 都心中心部における容積率の緩和 駅前の3ゾーンの容積率を800%に設定する。施策の開始年次は2025年とする。 都市機能誘導区域における建替促進助成 都市機能誘導区域内の商業地価割増率を「20%」に設定する。施策の開始年次は2025年とする。 2.6.2.1.1. 都心中心部における容積率の緩和の設定 下図のとおりにシナリオ名（シナリオ名は任意）、シナリオ開始年次、シナリオ終了年次を入力する。また、都市計画情報の容積率、開始年次、終了年次を入力する。 また、対象となる駅前のゾーンを複数選択する（今回は3つのゾーン）。 ※「マップ」タブの選択ツールで、Shiftを押しながらクリックすることで複数選択可能。 2.6.2.1.2. 都市機能誘導区域における建替促進助成① 都市機能誘導区域のポリゴンデータを用意し、レイヤーに追加する。 ※下図のように対象となるポリゴンデータ（shp形式等）をマップ上にドラッグアンドドロップする。 2.6.2.1.3. 都市機能誘導区域における建替促進助成② 都市機能誘導区域のポリゴンに重なるゾーンを選択する。 ※「マップ」タブの「空間条件で選択」ボタンをクリックすることで下図のような画面が表示される。入力フィーチャーにZoneData、選択フィーチャに対象となるポリゴンデータを設定し「適用」または「OK」をクリックすることで、条件と合うゾーンが選択される。 2.6.2.1.4. 都市機能誘導区域における建替促進助成③ ゾーンを選択した状態のままで、下図のとおりにシナリオ名（シナリオ名は都心中心部における容積率の緩和の設定の際に入力したものと同じもの）、シナリオ開始年次、シナリオ終了年次を入力する。また、地価変更割合の商業地価割増率、開始年次、終了年次を入力する。 2.6.2.2. シナリオ②：交通改善シナリオ 交通改善シナリオとして、2020年をシミュレーション開始年次とし、20年後の2040年までをシミュレーションする。 具体の施策としては「東西幹線のバス運行頻度改善」を設定することとする。 施策 設定内容 東西幹線のバス運行頻度改善 東西幹線エリア内を移動する場合の、バスの待ち時間を半分に設定する。施策の開始年次は2030年とする。 対象となるエリアのポリゴンを用意し、条件に合うゾーンを選択する。（ポリゴンを活用したゾーンの選択方法は「シナリオ①：都市機能誘導シナリオ」を参照） 下図のとおりにシナリオ名（シナリオ名は任意）、シナリオ開始年次、シナリオ終了年次を入力する。また、公共交通のバス待ち時間、開始年次、終了年次を入力する。 ※選択したゾーン間のバス待ち時間のみを半分にする（選択したゾーンとそれ以外の地域のバス待ち時間は変更なし）"
  }
}